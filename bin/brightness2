#! /bin/bash

# list of viable controls
brightness_class[0]="intel_backlight"
brightness_class[1]="toshiba"

# select brightness control
i=0
if [[ -z $2 ]]; then
    i=$2
fi

brightness_control_file="/sys/class/backlight/${brightness_class[$i]}/brightness"
max_brightness=`cat /sys/class/backlight/${brightness_class[$i]}/max_brightness`

brightness_percent=$1

divisor=`echo "scale=4; 100/$max_brightness" | bc`
brightness=`echo "$brightness_percent/$divisor" | bc`

if [[ "$brightness" -gt "$max_brightness" ]]; then
    echo "$brightness > max brightness($max_brightness)"
    echo "Setting to max"
    brightness=$max_brightness
fi
echo "$brightness" > $brightness_control_file
