#! /bin/bash

INRES="1600x900"                                           # input resolution
OUTRES="800x450"                                           # Output resolution
FPS="30"                                                   # target FPS
QUAL="medium"                                              # /usr/share/ffmpeg

# Write your key in a file named .twitch_key in your home directory
STREAM_KEY=$(cat ~/.twitch_key)   # This is your streamkey generated by jtv/twitch found at: http://www.justin.tv/broadcast/adv_other Â 

#ffmpeg \
    #-f x11grab -s $INRES  -r "$FPS" -i :0.0+160,90 \
    #-f alsa -ac 2 \
    #-vcodec libx264 -s $OUTRES -preset $QUAL \
    #-acodec libmp3lame -ar 44100 -threads 6 -qscale 3 -b 712000  -bufsize 512k \
    #-f flv "rtmp://live.twitch.tv/app/$STREAM_KEY"


ffmpeg -f x11grab -s $INRES -r $FPS -i :0.0+160,90 \
    -vcodec libx264 -preset ultrafast -pix_fmt yuv420p \
    -x264opts vbv-bufsize=3600:vbv-maxrate=1800:crf=23\
    -threads 5 -f flv \
    "rtmp://live.twitch.tv/app/$STREAM_KEY"
